<app-dialog-header title="Repaying Checkout">
</app-dialog-header>

<mat-dialog-content class="dialog">

  <ng-container *ngIf="startProgress">
    <app-infinite-progress-bar
      [start]="true"
      [end]="finishProgress"
      (finish)="hideProgressbar()"
    >
    </app-infinite-progress-bar>
  </ng-container>

  <form [formGroup]="form">
    <div class="container">
      <div class="dialog-content dialog-padding">
        <div class="row mb-3 mt-4 mt-md-0 mb-5">
          <div class="col col-12 item item--description">
            You're about to repay the {{ shortLoanId }} loan. Please choose the
            amount you'd like/you want to pay.
          </div>
        </div>
        <div class="row mb-4">
          <div class="col col-12 col-md-4 mb-3 mb-md-0 item item--entry">
            <p class="item__subtitle">
              Amount you want to pay
            </p>
            <mat-form-field
              class="mt-2"
              [class.mat-form-field--empty]="!form?.value.amount"
            >
              <input
                matInput
                type="number"
                min="0"
                max="1000000"
                formControlName="amount"
                placeholder="0"
                pattern="^(0*[1-9][0-9]*(\.[0-9]+)?|0+\.[0-9]*[1-9][0-9]*)$"
                [readonly]="loading"
                required
              />
              <span class="currency">
                {{ currency?.symbol }}
              </span>
            </mat-form-field>
          </div>
          <div class="col col-12 col-md-4 offset-md-4 mb-3 mb-md-0 item item--amount">
            <p class="item__subtitle">
              Due
            </p>
            <p class="item__value">
              <strong class="item__value-amount">
                {{ pendingAmount }}
              </strong>
              <span class="item__value-currency">
                {{ currency?.symbol }}
              </span>
            </p>
          </div>
        </div>
      </div>

      <div class="margintop15"></div>

      <div class="dialog-divisor dialog-padding py-0 mt-4 mt-md-0 row">
        <div class="dialog-divisor__content col-sm-12">
          <i class="material-icons mr-2">
            info
          </i>
          The value of the payments it's going to be converted to RCN.
        </div>
      </div>

      <div class="margintop20"></div>

      <div class="dialog-footer dialog-padding pt-0 pb-3 row">
        <div class="dialog-footer__label col-sm-12 col-md-6">
          <p>
            Repaying from the address <strong>{{ shortAccount }}</strong>.
          </p>
        </div>
        <div class="dialog-footer__buttons col-sm-12 col-md-6 pb-1 px-md-0">
          <div class="row justify-content-end">
            <div class="col-md-12">
              <app-pay-button
                [loan]="loan"
                [amount]="form.value.amount"
                [disabled]="loading || !form?.valid"
                (startPay)="showProgressbar()"
                (endPay)="endPay()"
              ></app-pay-button>
              <app-close-button class="d-none d-md-inline"></app-close-button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </form>
</mat-dialog-content>
